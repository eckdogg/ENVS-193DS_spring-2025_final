---
title: "ENVS193DS Final"
author: Owen Eckweiler
date: 6/10/2025
editor: source
format:
  html:
    toc: true # use this to display a table of contents
execute:
  message: false # use this to make sure messages don't show up
  warning: false # use this to make sure warnings don't show up
---

# Repository Link

<https://github.com/eckdogg/ENVS-193DS_spring-2025_final.git>


# Set up

```{r}
library("tidyverse")
library("here")
library("janitor")
library("tibble")

sst <- read_csv(here("data", "SST_update2023.csv"))
nest_boxes <- read_csv(here("data", "occdist.csv"))
```


# Problem 1. Research writing

## a. 

In part 1, they used a Pearson's r correlation test. In part 2, they used a one-way ANOVA test.

## b. 

Two additional tests that could be included are a Tukey's HSD test and an eta-squared test. Tukey's HSD will tell us what groups are significantly different from each other. In this example there are 5 groups (urban land, atmospheric deposition, fertilizer, wastewater treatment, and grasslands). An eta-squared test will give us the effect size between groups. Effect size will tell us how large the difference is between groups. 

## c.

We rejected the null hypothesis that there is no difference in average nitrogen load (kg year<sup>-1</sup>) between sources (urban land, atmospheric deposition, fertilizer, wastewater treatment, and grasslands) (p = 0.02). We found a large difference ($\eta^2$ = effect size) between sources in average nitrogen load (one-way ANOVA results). On average urban land tended to have larger nitrogen loads than atmospheric deposition (Tukey's HSD results), fertilizer (Tukey's HSD results), fertilizer (Tukey's HSD results), wastewater treatment (Tukey's HSD results), and grasslands (Tukey's HSD results).


# Problem 2. Data visualization

## a.

```{r}
sst_clean <- sst |> # cleaning data from sst data frame
  mutate(date = ymd(date), # creating date objects
         year = factor(year(date), levels = 2018:2023), # turning year variable into a factor
         month = month(date, label = TRUE, abbr = TRUE)) |> # creating a month column
  filter(!is.na(year)) |> # filtering out rows without a year value
  group_by(year, month) |> # grouping by year and month
  summarize(mean_monthly_sst = round(mean(temp, na.rm = TRUE), 1),
            .groups = "drop") # taking the mean sst for each month

sst_clean |> 
  slice_sample(n = 5) # displaying 5 random rows of data

str(sst_clean) # displaying the data structure
```

## b.

```{r}
ggplot(sst_clean, aes(x = month, y = mean_monthly_sst, group = year, color = year)) + # using sst_clean data frame and setting values
  geom_line(size = 0.8) + # line geometry
  geom_point(size = 1.5) + # point geometry
  labs( # setting axis labels
    x = "Month", # x axis label
    y = "Mean monthly sea surface temperature (Â°C)", # y axis label
    color = "Year" # coloring based on year
  ) +
  scale_color_manual( # manually setting color scale
    values = c(
      "2018" = "#deebf7", # color for 2018 (lightest blue)
      "2019" = "#c6dbef", # color for 2019
      "2020" = "#9ecae1", # color for 2020
      "2021" = "#6baed6", # color for 2021
      "2022" = "#3182bd", # color for 2022
      "2023" = "#08519c"  # color for 2023 (darkest blue)
    )
  ) +
  scale_y_continuous(limits = c(12, 20)) + # only displaying values between 12 and 20 on y axis
  theme_minimal(base_size = 14) + # setting base font size to 14 points
  theme(
    legend.position = c(0.00, 1.00),  # setting legend position
    legend.justification = c("left", "top"),  # pin legend to top-left
    plot.margin = margin(t = 10, r = 10, b = 10, l = 30), # setting plot margin
    axis.title.y = element_text(margin = margin(r = 10)), # setting margin for y axis
    panel.grid.major = element_blank(),  # removing major gridlines
    panel.grid.minor = element_blank(),  # removing minor gridlines
    panel.background = element_blank(),  # removing background
    panel.border = element_rect(color = "black", fill = NA, linewidth = 0.5)  # setting border color and size
  )
```


# Problem 3. Data analysis

## a.

A 1 represents the presence of a species and a 0 represents the absence of a species. For example a 1 underneath the sp column represents the presence of a swift parrot in a nest box.

## b.

In this study, the nest boxes were built for Swift Parrot habitat restoration. However in the location where the nest boxes were built there are two other species that compete with Swift Parrots for nest boxes (Tree Martins and Common Starlings).
